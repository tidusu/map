<!-- iFootboot串游记 -->
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>照片游记@打卡相册</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <link rel="stylesheet" href="if.css">
    <script type="text/javascript" src="if.js"></script>
</head>

<body>   
    <script>
        function page(r){var c=eval("(" + r + ")");var o="";var l="<div id='content'></div>";var m="<div id='map_box'><div id='main'></div><div id='map_btn'></div><div id='map'></div></div>";var j="<div id='thumbnail' class='thumbnail_box'></div>";var g="<div id='detail'></div>";var f="<div class='gap'></div>";var n="<img class='map_expand' src='img/expand.png' style='CURSOR: pointer' onclick='auto_zoom()' />";$(document.body).append(m);mapboxgl.accessToken="pk.eyJ1IjoiaWZvb2J0b29rIiwiYSI6ImNqdnczZ3plODF5dDE0YW5uNGhpNWcyanAifQ.qgmnnkw85aN0xuI2HVcgHw";var d=new mapboxgl.Map({container:"map",style:"mapbox://styles/ifoobtook/cjxytzz830e721cpqexucj195?optimize=true",zoom:2,center:[121.44,31.75],attributionControl:false,logoPosition:"bottom-left"});var b=new mapboxgl.LngLatBounds();var k=[];d.addControl(new mapboxgl.AttributionControl(),"top-right");function q(s){d.flyTo({center:s.geometry.coordinates,zoom:16})}c.features.forEach(function(y,x){if(x===0){var v=document.getElementById("main");var B=v.appendChild(document.createElement("div"));B.className="main_title";B.innerHTML=y.properties.title;var C=v.appendChild(document.createElement("div"));C.className="main_info";C.innerHTML=y.properties.imgShowDate;var t=document.getElementById("map_btn");var w=t.appendChild(document.createElement("img"));w.src="img/expand.png";w.className="map_expand";w.style="CURSOR: pointer";w.onclick=function(){auto_zoom()}}if(x>0){b.extend(y.geometry.coordinates);var A=y.geometry.coordinates[0];var z=y.geometry.coordinates[1];img_base64="data:image/jpg;base64,"+y.properties.imgBase64Data;k.push([Number(A),Number(z)]);var s=document.createElement("div");s.className="marker";s.innerHTML="<span><b>"+y.properties.id+"</b></span>";var u=document.createElement("div");u.className="marker_title";u.innerHTML="<span><b>"+y.properties.title+"</b></span>";new mapboxgl.Marker(u,{offset:[0,10],}).setLngLat(y.geometry.coordinates).addTo(d);new mapboxgl.Marker(s,{offset:[0,-10],}).setLngLat(y.geometry.coordinates).addTo(d);s.addEventListener("click",function(D){q(y)})}});auto_zoom=function(){d.fitBounds(b,{padding:50,maxZoom:15})};$(document.body).append(l);$("#content").append(j+g+f);auto_zoom();h(c);e(c);a();var p=$("#thumbnail").height();$(window).scroll(function(){if(document.body.scrollTop>p||document.documentElement.scrollTop>p){$("#map_box").css("transform","translateY(-400px)")}else{$("#map_box").css("transform","translateY(0px)")}});function h(v){for(i=1;i<v.features.length;i++){var u=v.features[i];var z=u.properties;var y="data:image/jpg;base64,"+z.imgBase64Data;var x=document.getElementById("thumbnail");var w=x.appendChild(document.createElement("div"));w.className="thumbnail_group";w.id="thumbnail-"+i;var s=w.appendChild(document.createElement("img"));s.src=y;s.className="thumbnail_img";s.dataPosition=i;s.innerHTML=z.Name;var t=w.appendChild(document.createElement("div"));t.className="thumnail_num";t.dataPosition=i;t.innerHTML=""+i;s.addEventListener("click",function(A){var B=v.features[this.dataPosition];q(B)});t.addEventListener("click",function(A){var B=v.features[this.dataPosition];q(B)})}}function e(z){for(i=1;i<z.features.length;i++){var u=z.features[i];var t=u.properties;var E=u.geometry.coordinates[0];var D=u.geometry.coordinates[1];var G="data:image/jpg;base64,"+t.imgBase64Data;var s=document.getElementById("detail");var C=s.appendChild(document.createElement("div"));C.className="img_detail";var y=C.appendChild(document.createElement("img"));y.src=G;y.className="detail_img";var B=C.appendChild(document.createElement("div"));B.className="num";B.innerHTML=""+i;var x=C.appendChild(document.createElement("div"));x.className="info_box";var F=x.appendChild(document.createElement("div"));F.innerHTML=t.title;F.className="title";var w=x.appendChild(document.createElement("div"));w.innerHTML=t.imgShowDate;w.className="time";var v=x.appendChild(document.createElement("div"));v.innerHTML=t.imgDescribe;v.className="info";var A=x.appendChild(document.createElement("div"));A.className="squaremap";var H=A.appendChild(document.createElement("img"));H.src="https://maps.google.cn/maps/api/staticmap?size=500x200&zoom=12&scale=2&maptype=roadmap&key=AIzaSyBjIiySGuqzdkj5hxExGJLVT-0CYfl3OfE&markers=color:red%7C"+D+","+E;H.className="squaremap"}}function a(){var s=turf.lineString(k);d.on("load",function(){d.addLayer({"id":"route","type":"line","source":{"type":"geojson","data":s},"layout":{"line-join":"round","line-cap":"round"},"paint":{"line-color":"#0192FA","line-opacity":0.5,"line-width":5}})})}};
    </script>

    <script>  
        $(document).ready(page(json));
    </script>
</body>

</html>