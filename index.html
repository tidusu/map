<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <title>Locate the user</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.css' rel='stylesheet' />
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
</head>

<body>
    <div id='map'></div>
    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoidGlkdXN1IiwiYSI6InUydm90aGcifQ.Euyt9iGBfTtCAO8xflSyww';
        var map = new mapboxgl.Map({
            container: 'map', // container id
            style: 'mapbox://styles/mapbox/streets-v11',
            center: [121.50454, 31.306], // starting position
            zoom: 18 // starting zoom
        });

        // map.on('load', function () {
        //     map.addLayer({
        //         'id': 'maine',
        //         'type': 'fill',
        //         'source': {
        //             'type': 'geojson',
        //             'data': {
        //                 'type': 'Feature',
        //                 "geometry": {
        //                     "type": "Polygon",
        //                     "coordinates": [
        //                         [
        //                             [
        //                                 121.504325866699,
        //                                 31.3060569763184
        //                             ],
        //                             [
        //                                 121.504325866699,
        //                                 31.3062286376953
        //                             ],
        //                             [
        //                                 121.504669189453,
        //                                 31.3062286376953
        //                             ],
        //                             [
        //                                 121.504669189453,
        //                                 31.3060569763184
        //                             ],
        //                             [
        //                                 121.504325866699,
        //                                 31.3060569763184
        //                             ],
        //                             [
        //                                 121.504325866699,
        //                                 31.3058853149414
        //                             ],
        //                             [
        //                                 121.504325866699,
        //                                 31.3060569763184
        //                             ],
        //                             [
        //                                 121.504669189453,
        //                                 31.3060569763184
        //                             ],
        //                             [
        //                                 121.504669189453,
        //                                 31.3058853149414
        //                             ],
        //                             [
        //                                 121.504325866699,
        //                                 31.3058853149414
        //                             ]
        //                         ]
        //                     ]
        //                 }
        //             }
        //         },
        //         'paint': {
        //             'fill-color': '#088',
        //             'fill-opacity': 0.8
        //         }
        //     });
        //     // Add geolocate control to the map.

        // });

    

        map.addControl(new mapboxgl.GeolocateControl({
            positionOptions: {
                enableHighAccuracy: true
            },
            trackUserLocation: true
        }));


        // map.on('load', function () {
        //     if (navigator.geolocation) {
        //     navigator.geolocation.getCurrentPosition(onSuccess, onError);
        // } else {
        //     alert("您的浏览器不支持使用HTML 5来获取地理位置服务");
        // }
        // //定位数据获取成功响应
        // function onSuccess(position) {
        //     alert('纬度: ' + position.coords.latitude + '\n' +
        //         '经度: ' + position.coords.longitude + '\n' +
        //         '海拔: ' + position.coords.altitude + '\n' +
        //         '水平精度: ' + position.coords.accuracy + '\n' +
        //         '垂直精度: ' + position.coords.altitudeAccura)
        // }
        // //定位数据获取失败响应
        // function onError(error) {
        //     switch (error.code) {
        //         case error.PERMISSION_DENIED:
        //             alert("您拒绝对获取地理位置的请求");
        //             break;
        //         case error.POSITION_UNAVAILABLE:
        //             alert("位置信息是不可用的");
        //             break;
        //         case error.TIMEOUT:
        //             alert("请求您的地理位置超时");
        //             break;
        //         case error.UNKNOWN_ERROR:
        //             alert("未知错误");
        //             break;
        //     }
        // }
        // })

        // geohashpoly({coords: a, precision: 8}, function (err, hashes) {console.log(hashes);})
        //  [ 'wtw6hghg', 'wtw6hghf' ]
        //  {"type":"Polygon","coordinates":[[[121.504325866699,31.3060569763184],[121.504325866699,31.3062286376953],[121.504669189453,31.3062286376953],[121.504669189453,31.3060569763184],[121.504325866699,31.3060569763184]]]}
        // {"type":"Polygon","coordinates":[[[121.504325866699,31.3058853149414],[121.504325866699,31.3060569763184],[121.504669189453,31.3060569763184],[121.504669189453,31.3058853149414],[121.504325866699,31.3058853149414]]]}
        // geohashpoly({coords: a, precision: 9}, function (err, hashes) {console.log(hashes);})
    </script>

</body>

</html>